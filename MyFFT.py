import numpy as np
from numpy import fft
from scipy import signal

class MyFFT:
    def __init__(self):
        self.data = []
        self.samplerate = 256

    def fft(self,data,N=256):
        self.samplerate = N
        fw1 = signal.hann(self.samplerate)
        fft_result = []
        for norm in data:
            avg = sum(norm)/len(norm)
            blank = self.samplerate - len(norm)
            bef = blank//2
            af = blank - bef
            norm = [avg]*bef + norm + [avg]*af
            norm = [i-avg for i in norm]
            norm = norm * fw1
            fft_data = fft.fft(norm)
            #fft_data = abs(fft_data/(1/len(fft_data)))
            fft_data = np.log(abs(fft_data)**2)
            fft_data = fft_data[:self.samplerate//2]
            fft_data[:2] = 0
            fft_result.append(fft_data.tolist())
        self.data = fft_result

    def get_fft_data(self):
        return self.data

if __name__ == "__main__":
    myfft = MyFFT()
    myfft.fft([{"norm": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.803143790978677, 9.99883979496149, 9.99819573339881, 9.938283917636015, 9.548453795799153, 9.406254328558516, 9.302372806251304, 9.498444903785652, 10.167272494747285, 10.279365504152766, 10.163781258789983, 9.745029611310178, 9.409566199221983, 9.613773225199441, 9.485519640857394, 9.48055338214286, 9.694892645178035, 9.975565851316118, 10.033232073482257, 9.981413539523462, 9.884968270742451, 9.714541440919712, 9.744678402387244, 9.780028151407546, 9.79389314484071, 9.638126774751477, 9.501370992998405, 9.365504600406458, 9.28429907492375, 9.332620975083698, 9.344198304946453, 9.50898098690059, 9.553864741021094, 9.14155012205415, 9.20113627122708, 9.341042708582432, 9.796819956366491, 10.02463148150749, 9.853949561604907, 9.770451084970448, 9.675965105642451, 9.750530196798394, 9.736234764974013, 9.516138279481174, 9.078315463152304, 8.709087815195186, 8.574856211622729, 8.558280827485147, 8.73642271594012, 8.916393746207808, 9.120609547173503, 9.341213697998256, 9.420988476759344, 9.390109559317011, 9.427147335531851, 9.850955410598964, 10.085690983583262, 9.981975647745386, 9.724562427527987, 9.462492400008257, 9.168700507452215, 9.304592013894066, 9.312424542167028, 9.429180593333866, 9.62100186178463, 9.746543095813589, 9.761820215872344, 9.712985527269682, 9.749134153502084, 9.828192263209932, 9.792739684646543, 9.707208544587926, 9.66271972902996, 9.57892390802027, 9.60352461072936, 9.59734900137122, 9.740661695523777, 9.878724287704207, 9.870788022346128, 9.837905523818472, 9.705416627369681, 9.680148083691144, 9.733209529655724, 9.977514431915177, 10.522526302864076, 10.832654098022347, 10.89633785158739, 10.726861202466425, 10.29921274805378, 9.611347657710832, 9.271328271809143, 9.145585972966883, 9.076847429409938, 8.972722299140424, 8.88250540528904, 8.862014469262222, 9.0409017663919, 9.225102472786228, 9.43069203401461, 9.65174591110623, 9.859148644882339, 10.174519635091261, 10.490275337104098, 10.795111401797113, 10.900140813515442, 10.955994157755903, 10.958420305968197, 10.950613432525572, 10.870972366260258, 10.764221472796079, 10.461294862260152, 10.2195047485213, 9.962047121918165, 9.879300794965712, 9.749591844629402, 9.686630878174276, 9.693900829388935, 9.687537570253324, 9.758314922227774, 9.592157100161426, 9.59806284181906, 9.749553968791792, 9.712527612174698, 9.768418730707065, 10.039969528422144, 10.380580303791351, 10.701288574382001, 10.496220330097538, 9.441074156944646, 8.544596882147188, 7.678760373165567, 8.426665208331835, 8.56511720772477, 9.102163436444119, 9.339215503608962, 8.927150087058022, 8.512166806288647, 8.721072845962132, 9.66897571392354, 10.340038439457988, 10.66866435278086, 10.884421808553359, 10.956924192924518, 10.416083069252611, 9.586814894828086, 9.088160979383625, 9.116723311821396, 9.16677868856669, 8.922015466807714, 9.010970085680286, 9.53311219558295, 9.265121683507262, 8.895017784686313, 9.128732307643157, 9.53737300223574, 9.654761790180387, 9.422916116192535, 9.523177939565555, 9.671968758173634, 9.624334938780665, 9.573819998292555, 9.633817569067714, 10.522529597698291, 10.918719055973021, 10.906106468338592, 10.381526499589915, 9.480194688890677, 8.987899907497239, 8.882119298814434, 9.185565305297285, 9.436569138867432, 9.700193414540363, 9.957985290901476, 10.150534109486388, 10.212927640433062, 10.002571873371107, 10.17944724905566, 10.555384555611697, 10.763314878979688, 10.602991403581045, 10.269883695575311, 10.052171314112513, 9.740463741427224, 9.544039637036198, 9.367791275915202, 9.30430354206063, 9.305459493014395, 9.312908605225065, 9.58590339002859, 9.879702020367306, 10.044173002067405, 10.220437683347425, 10.305603500906347, 10.368964428742693, 10.325821114572783, 10.15830106737213, 10.217367075419087, 10.17156336388647, 10.178256038578699, 9.985797929501421, 9.994783972881486, 9.912770237787866, 9.810936525066431, 9.637460233343747, 9.645831549457451, 9.837594584602936, 9.840493671795471, 9.767949670845228, 9.752379466612282, 9.7527280349267, 9.631241788436391, 9.583797745218254, 9.580814119842769, 9.581758522620444, 9.533440447948788, 9.42296942699501, 9.551435972913973, 9.384879971342468, 9.4746981149137, 9.389296852526096, 9.1480841122888, 9.292563865796469, 9.433588357338667, 9.516510016662558, 9.450833370444093, 9.348510764194694, 9.31169167874154, 9.361352988749461, 9.412782260065592, 9.894367638366106, 10.085054771826368, 10.178456658627423, 10.35275675627159, 10.628678929391189, 10.662304956518735, 10.618375698394383, 10.442805198798398], "gyro": []},{"norm": [10.028550906141353, 10.051929938772586, 10.076413703341291, 10.040907321269605, 10.074829468236171, 10.063232666948803, 10.055450105138748, 10.013498789812541, 10.133830897892665, 10.051238948922476, 10.079080043373246, 10.094633930177455, 10.060076121917312, 10.080151143579313, 10.056130479325208, 10.07927965195328, 10.081255238009254, 10.060535015336262, 10.063406460391061, 10.021589672982712, 10.080993578767275, 10.083180377436596, 10.04103318875081, 10.017048852455046, 10.022334507024432, 10.070421190979898, 10.065344621668972, 10.0593451971616, 10.061643239410094, 10.063994799656744, 10.060094488795626, 10.093241197891881, 10.042966404773328, 10.050768306185688, 10.039779016110959, 10.072273518136353, 10.076854983607031, 10.049948339382153, 10.025438759842745, 10.076510520248027, 10.051902586476032, 10.10234935186306, 10.057087316225925, 10.058176586449813, 10.044625506755327, 10.037701071943431, 10.055269249477107, 10.088961548333794, 10.058949630327826, 10.092017741258351, 10.076865217242938, 10.053545115385727, 10.06511761666547, 10.099409218671354, 10.094978562355225, 10.100043001578186, 10.121026875462796, 10.096385908204573, 10.087698850399647, 10.053070852852315, 10.034173350808738, 10.09581248479744, 10.032334266078308, 10.105829550193139, 10.047459402215742, 10.072567183675718, 10.098427185787179, 10.092348084269386, 10.01728585539375, 10.011419690731408, 10.062677920710945, 10.028008485560635, 10.030812645013178, 10.059134757167447, 10.043252514703676, 10.08853501759608, 10.052698621953107, 10.09157636953899, 10.079385898546441, 10.090207377476618, 10.049274877971142, 10.09014219469823, 10.048903448833833, 10.043286590171402, 10.040990720924372, 10.06724669947681, 10.14337954375524, 10.038106033796511, 10.05515480655879, 10.085274217525917, 10.007276298672243, 10.054761929189782, 10.031700160981687, 10.077044804855197, 10.105483377452762, 10.077121194556575, 10.102261322950914, 10.049850407616201, 10.050619614025457, 10.074830319682437, 10.064295480076515, 10.090668227999995, 10.070987086916062, 10.080282221523348, 10.060180466533147, 10.03660324770007, 10.06277159968306, 10.051921825229549, 10.071660605829045, 10.096222064178875, 10.053842009353417, 10.076606063682057, 10.061081830115285, 10.090493661791152, 10.052996011830452, 10.050726689221289, 10.020715605067648, 10.069074760821524, 10.034860410872971, 10.082634281543502, 10.052791604627014, 10.078094992478626, 10.047877025294115, 10.059892083544442, 10.007547725752499, 10.076929343587558, 10.034812152939692, 10.087680220493425, 10.094026942143543, 10.052086540190562, 10.09920053209162, 10.079573764183104, 10.016507981270282, 10.066764211476569, 10.088119221884792, 10.04704030117294, 10.058673969253208, 10.075898716101577, 10.033390989462092, 10.020045920349828, 10.03986579804592, 10.04653654416487, 10.034986280191951, 10.058099768632603, 10.07760674553838, 10.085975071452904, 10.100545750098494, 10.10115976324189, 10.066559047160267, 10.098236754278137, 10.057957153507383, 10.05964753790609, 10.090548964361776, 10.104628662788924, 10.08036338527451, 10.052159569780194, 10.029734298142198, 10.066065534625494, 10.1023343228286, 10.086827850556135, 10.033198931154699, 10.056588842974628, 10.060283266755741, 10.046985270601807, 10.079051916087513, 10.066801223345136, 10.099705018483112, 10.07828495826178, 10.073101015499548, 10.043824128242758, 10.043356700103548, 10.045257515623431, 10.05339507174349, 10.019002443316419, 10.092265555653539, 10.074617117752306, 10.077274192431531, 10.101535978656822, 10.123282738890557, 10.02794833001049, 10.100079859136589, 10.067541281927792, 10.064388792822907, 10.05705751775817, 10.068756211420862, 10.096547550564711, 10.09324122078619, 10.04589996464325, 10.101175915233972, 10.040870447535085, 10.086422833165832, 10.079926148140954, 10.051656263815516, 10.077932000845703, 10.09278311852979, 10.066252807291686, 10.03661687176852, 10.042918538210056, 10.093273912225632, 10.0839476782525, 10.07023182334541, 10.072603109708535, 10.070920002222865, 10.024315418216407, 10.085733051409788, 10.124261939165903, 10.063491411681158, 10.056445875043577, 10.055954812481508, 10.046135585107361, 10.036983164521446, 10.05481936387702, 10.064292422444225, 10.089255915386365, 10.051665653837675, 10.070633528260691, 10.068131859655326, 10.07484701542551, 10.012110775882476, 10.018614110813289, 10.050792581105357, 10.084763802040417, 10.060195194919167, 10.046778744372142, 10.061038750408809, 10.017302106169367, 10.063776736091135, 10.075104587051614, 10.07837173007784, 10.096362891253317, 10.066961227595499, 10.045706812817128, 10.0166947279124, 10.041851301430441, 10.053628692781338, 10.03615167867769, 10.060423914519994, 10.041162809465987, 10.103829354131639, 10.094196314529823], "gyro": []}])
    print(myfft.get_fft_data()) 